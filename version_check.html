<!DOCTYPE html>
<html>
<head>
    <title>Combat Closet Version Check</title>
    <style>
        body {
            margin: 0;
            padding: 8px;
            font-family: Arial, sans-serif;
            background: rgb(0, 11, 25);
            color: #ffffff;
            font-size: 14px;
        }

        .version-container {
            text-align: center;
            padding: 10px;
        }

        .version-item {
            margin: 8px 0;
            padding: 6px;
            border-radius: 4px;
        }

        .current-version {
            background: rgba(135, 206, 235, 0.15);
            border: 1px solid rgba(135, 206, 235, 0.3);
            color: #87CEEB;
        }

        .latest-version {
            background: rgba(255, 215, 0, 0.15);
            border: 1px solid rgba(255, 215, 0, 0.3);
            color: #FFD700;
            font-weight: bold;
        }

        .vs-divider {
            color: #666;
            margin: 6px 0;
            font-size: 12px;
        }

        .status {
            margin-top: 12px;
            padding: 8px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 13px;
        }

        .up-to-date {
            background: rgba(144, 238, 144, 0.2);
            border: 1px solid rgba(144, 238, 144, 0.4);
            color: #90EE90;
        }

        .update-available {
            background: rgba(255, 107, 107, 0.2);
            border: 1px solid rgba(255, 107, 107, 0.4);
            color: #FF6B6B;
        }

        .version-number {
            font-size: 16px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="version-container">
        <div class="version-item current-version">
            Your version: <span class="version-number" id="currentVersion">Loading...</span>
        </div>

        <div class="vs-divider">VS</div>

        <div class="version-item latest-version">
            Latest version: <span class="version-number" id="latestVersion">1.1.0</span>
        </div>

        <div class="status" id="status">Checking...</div>
    </div>

    <script>
        
        const urlParams = new URLSearchParams(window.location.search);
        const currentVersion = urlParams.get('current') || 'Unknown';
        const latestVersion = document.getElementById('latestVersion').textContent.trim();

        
        document.getElementById('currentVersion').textContent = currentVersion;

        
        function compareVersions(current, latest) {
            const parseVersion = (v) => v.split('.').map(num => parseInt(num, 10));
            const currentParsed = parseVersion(current);
            const latestParsed = parseVersion(latest);

            for (let i = 0; i < Math.max(currentParsed.length, latestParsed.length); i++) {
                const currentNum = currentParsed[i] || 0;
                const latestNum = latestParsed[i] || 0;
                if (latestNum > currentNum) return 1;
                if (latestNum < currentNum) return -1;
            }
            return 0;
        }

        const comparison = compareVersions(currentVersion, latestVersion);
        const statusElement = document.getElementById('status');

        if (comparison > 0) {
            statusElement.textContent = 'ðŸ”„ Update Available - Please update via Discord or Manager';
            statusElement.className = 'status update-available';
        } else if (comparison === 0) {
            statusElement.textContent = 'âœ… You have the latest version!';
            statusElement.className = 'status up-to-date';
        } else {
            statusElement.textContent = 'ðŸš€ You have a newer version than released!';
            statusElement.className = 'status up-to-date';
        }

        
        setTimeout(function() {
            try {
               
                if (window.parent && window.parent._G && window.parent._G.OnVersionCheckComplete) {
                    window.parent._G.OnVersionCheckComplete(currentVersion, latestVersion, comparison);
                } else if (window._G && window._G.OnVersionCheckComplete) {
                    window._G.OnVersionCheckComplete(currentVersion, latestVersion, comparison);
                } else if (window.top && window.top._G && window.top._G.OnVersionCheckComplete) {
                    window.top._G.OnVersionCheckComplete(currentVersion, latestVersion, comparison);
                }
            } catch (e) {
                console.log('Could not call back to addon:', e);
            }
        }, 1000); 
    </script>
</body>
</html>
